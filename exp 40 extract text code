import cv2
import pytesseract

# Set Tesseract path (change if needed)
pytesseract.pytesseract.tesseract_cmd = r"C:\Program Files\Tesseract-OCR\tesseract.exe"

def extract_text():

    cap = cv2.VideoCapture("input.mp4")

    if not cap.isOpened():
        print("Error opening video")
        return

    frame_count = 0
    last_text = ""

    while True:
        ret, frame = cap.read()
        if not ret:
            break

        frame_count += 1

        # Process every 15th frame
        if frame_count % 15 == 0:

            gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)
            gray = cv2.GaussianBlur(gray, (5, 5), 0)

            _, thresh = cv2.threshold(gray, 150, 255, cv2.THRESH_BINARY)

            custom_config = r'--oem 3 --psm 6'
            text = pytesseract.image_to_string(thresh, config=custom_config).strip()

            if text != "" and text != last_text and len(text) > 3:
                print(f"\nFrame {frame_count} Text:")
                print(text)
                last_text = text

        cv2.imshow("Video", frame)

        if cv2.waitKey(25) & 0xFF == ord('q'):
            break

    cap.release()
    cv2.destroyAllWindows()

extract_text()
